<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>å­¦ç”Ÿè½¬åŒ–ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/v3.2.8/vue.global.prod.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <div id="app">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <div class="top-nav">
            <div class="nav-left">
                <div class="brand-logo">
                    <img src="https://m.xiwang.com/resources/xiwang-silogan-transp-4JVkSwWn3xyyRXxbblADB.png" alt="å¸Œæœ›å­¦" class="logo-image">
                </div>
                <div class="nav-divider"></div>
                <h1 class="nav-title">åˆä¸­å¤§Leadsæ„å‘åº¦</h1>
            </div>
            <div class="nav-right">
                <div class="user-info">
                    <div class="user-avatar">
                        <img :src="currentUser.avatar" :alt="currentUser.name">
                    </div>
                    <span class="user-name">{{ currentUser.name }}</span>
                </div>
            </div>
        </div>
        
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-container">
            <!-- é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡ -->
            <div class="stats-cards">
                <div class="stat-card stat-card-1">
                    <div class="stat-label">B+å­¦å‘˜ï¼ˆæœªè½¬åŒ–ï¼‰</div>
                    <div class="stat-value">{{ stats.bPlus }}ä¸ª</div>
                    <div class="stat-percent">å æ¯”{{ stats.bPlusPercent }}%</div>
                </div>
                <div class="stat-card stat-card-2">
                    <div class="stat-label">Bå­¦å‘˜ï¼ˆæœªè½¬åŒ–ï¼‰</div>
                    <div class="stat-value">{{ stats.b }}ä¸ª</div>
                    <div class="stat-percent">å æ¯”{{ stats.bPercent }}%</div>
                </div>
                <div class="stat-card stat-card-3">
                    <div class="stat-label">B-å­¦å‘˜ï¼ˆæœªè½¬åŒ–ï¼‰</div>
                    <div class="stat-value">{{ stats.bMinus }}ä¸ª</div>
                    <div class="stat-percent">å æ¯”{{ stats.bMinusPercent }}%</div>
                </div>
                <div class="stat-card stat-card-4">
                    <div class="stat-label">å·²è½¬åŒ–å­¦å‘˜</div>
                    <div class="stat-value">{{ stats.converted }}ä¸ª</div>
                    <div class="stat-percent">è½¬åŒ–ç‡{{ stats.conversionRate }}%</div>
                </div>
            </div>


            <!-- æœç´¢ç­›é€‰åŒºåŸŸ -->
            <div class="filter-bar">
                <div class="filter-item">
                    <label>å§“å</label>
                    <div class="input-with-icon">
                        <input type="text" v-model="filters.name" placeholder="è¯·è¾“å…¥å§“å" @keyup.enter="search">
                        <span class="icon-search">ğŸ”</span>
                    </div>
                </div>
                <div class="filter-item">
                    <label>ç”µè¯</label>
                    <div class="input-with-icon">
                        <input type="text" v-model="filters.phone" placeholder="è¯·è¾“å…¥ç”µè¯" @keyup.enter="search">
                        <span class="icon-search">ğŸ”</span>
                    </div>
                </div>
                <div class="filter-item">
                    <label>å­¦å‘˜ID</label>
                    <div class="input-with-icon">
                        <input type="text" v-model="filters.studentId" placeholder="è¯·è¾“å…¥å­¦å‘˜ID" @keyup.enter="search">
                        <span class="icon-search">ğŸ”</span>
                    </div>
                </div>
                <div class="filter-item">
                    <label>æ„å‘åº¦</label>
                    <select v-model="filters.intention" class="select-input">
                        <option value="">å…¨éƒ¨</option>
                        <option value="bPlus">B+å­¦å‘˜</option>
                        <option value="b">Bå­¦å‘˜</option>
                        <option value="bMinus">B-å­¦å‘˜</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>è½¬åŒ–çŠ¶æ€</label>
                    <select v-model="filters.converted" class="select-input">
                        <option value="">å…¨éƒ¨</option>
                        <option value="true">å·²è½¬åŒ–</option>
                        <option value="false">æœªè½¬åŒ–</option>
                    </select>
                </div>
                <button class="search-btn-new" @click="search">æŸ¥è¯¢</button>
                <button class="reset-btn" @click="resetFilters">é‡ç½®</button>
            </div>

            <!-- å­¦ç”Ÿå¡ç‰‡åˆ—è¡¨ -->
            <div class="cards-container">
                <!-- åŠ è½½çŠ¶æ€ -->
                <div v-if="loading" class="loading">
                    <div class="spinner"></div>
                    <p>æ­£åœ¨åŠ è½½ä¸­...</p>
                </div>

                <!-- ç©ºçŠ¶æ€ -->
                <div v-else-if="displayStudents.length === 0" class="empty-state">
                    <div style="font-size: 60px; margin-bottom: 20px;">ğŸ“š</div>
                    <p>æš‚æ— å­¦ç”Ÿæ•°æ®</p>
                </div>

                <!-- å­¦ç”Ÿå¡ç‰‡ -->
                <div v-else class="student-cards">
                    <div 
                        v-for="student in displayStudents" 
                        :key="student.id" 
                        class="student-card"
                    >
                        <div class="card-header">
                            <div class="card-left">
                                <div class="student-avatar-large">
                                    <img :src="student.avatar" :alt="student.name">
                                </div>
                                <div class="student-basic">
                                    <div class="student-name-large">{{ student.name }}</div>
                                    <div class="student-tags">
                                        <span class="tag tag-grade">{{ student.grade }}</span>
                                        <span class="tag tag-gender">{{ student.gender }}</span>
                                        <span class="tag tag-city">{{ student.city }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="card-right">
                                <div 
                                    class="level-badge"
                                    :class="getLevelClass(student.probability)"
                                >
                                    {{ getLevelLabel(student.probability) }}
                                </div>
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="info-item">
                                <span class="info-label">å­¦ç”ŸIDï¼š</span>
                                <span class="info-value">{{ student.id }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">è¯¾ç¨‹åç§°ï¼š</span>
                                <span class="info-value">{{ student.courseName }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">æ„å‘åº¦ï¼š</span>
                                <span class="info-value probability-text" :class="getProbabilityClass(student.probability)">
                                    {{ student.probability }}%
                                </span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">è½¬åŒ–çŠ¶æ€ï¼š</span>
                                <span class="info-value" :class="student.converted ? 'converted-yes' : 'converted-no'">
                                    {{ student.converted ? 'å·²è½¬åŒ–' : 'æœªè½¬åŒ–' }}
                                </span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="action-btn action-btn-secondary" @click="callPhone(student.phone)">
                                ğŸ“ ç”µè¯è”ç³»
                            </button>
                            <button class="action-btn action-btn-secondary" @click="contactWechat(student.id)">
                                ğŸ’¬ ä¼å¾®è”ç³»
                            </button>
                            <button class="action-btn action-btn-primary" @click="navigateToDetail(student.id)">
                                æŸ¥çœ‹è¯¦æƒ…
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- åˆ†é¡µ -->
            <div v-if="!loading && displayStudents.length > 0" class="pagination">
                <button 
                    class="page-btn" 
                    :disabled="currentPage === 1"
                    @click="changePage(currentPage - 1)"
                >
                    â€¹
                </button>
                <button 
                    v-for="page in visiblePages" 
                    :key="page"
                    class="page-btn"
                    :class="{ active: page === currentPage }"
                    @click="changePage(page)"
                >
                    {{ page }}
                </button>
                <button 
                    class="page-btn"
                    :disabled="currentPage === totalPages"
                    @click="changePage(currentPage + 1)"
                >
                    â€º
                </button>
            </div>
        </div>
        
        <!-- å³ä¾§æ‚¬æµ®æ’è¡Œæ¦œ -->
        <div class="floating-ranking" :class="{ collapsed: rankingCollapsed }">
            <div class="floating-ranking-header" @click="toggleRanking">
                <span class="ranking-icon">ğŸ†</span>
                <span v-if="!rankingCollapsed" class="ranking-title-text">è½¬åŒ–ç‡æ’è¡Œ</span>
                <button class="collapse-btn" @click.stop="toggleRanking">
                    {{ rankingCollapsed ? 'â€¹' : 'â€º' }}
                </button>
            </div>
            <div class="floating-ranking-content">
                <div class="top3-section">
                    <div v-for="(item, index) in topRanking" :key="item.id" class="mini-rank-item">
                        <div class="mini-medal" :class="'medal-' + (index + 1)">{{ index + 1 }}</div>
                        <div class="mini-teacher">{{ item.name }}</div>
                        <div class="mini-rate">{{ item.conversionRate }}%</div>
                    </div>
                </div>
                <div class="my-rank-section">
                    <div class="my-rank-label">æˆ‘çš„æ’å</div>
                    <div class="my-rank-value">ç¬¬{{ myRanking.rank }}å Â· {{ myRanking.conversionRate }}%</div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
